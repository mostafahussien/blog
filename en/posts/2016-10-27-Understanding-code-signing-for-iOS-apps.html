<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/blog/_next/static/css/48af12299ae627c52747.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/48af12299ae627c52747.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/4c0d4c8d51a982656861.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/4c0d4c8d51a982656861.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/blog/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/framework.15878d4e523f86636251.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/9b974c4f0af01532965b68ee65e3c6bfc9ba8874.7ca2816e457bafd5946e.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/main-c8c45755b4609bf23bc4.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/2b45cbd87133d4142bedfa00394b1b98eeb2e753.305d3433611fa22812ed.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/pages/_app-95468d8a5f6e7e48bae5.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/5993a6fbe10bd7e58099f74b46323b252f0ba77f.4070ac60c7c7fe2c9267.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/pages/%5Blang%5D/posts/%5Bslug%5D-2c24168649a128d0ac79.js" as="script"/></head><body><div id="__next"><div class="DefaultLayout_wrapper__1oHG7" data-theme="light"><header class="Header_header__ntZEq"><div style="box-sizing:border-box;position:relative;margin-left:auto;margin-right:auto;padding-left:12px;padding-right:12px"><div style="margin-left:-12px;margin-right:-12px;display:flex;flex-wrap:wrap;flex-grow:0;flex-shrink:0;align-items:center;justify-content:space-between;flex-direction:row" class="Header_headerWrapper__1YLHd"><a href="/blog/en"><img class="Header_logo__2T6w8" src="/blog/assets/img/logo/ml-logo-grey.png" alt=""/></a><button class="Header_button__1NPV1">Switch DarkMode</button><div><label class="language-switcher">Language<select><option selected="" value="en">en</option><option value="jp">jp</option></select></label></div></div><span style="display:table;clear:both"></span></div></header><main class="DefaultLayout_content__-kWCY"><div style="box-sizing:border-box;position:relative;margin-left:auto;margin-right:auto;padding-left:12px;padding-right:12px"><div class="ArticleBody_article__lIxTL"><div><p>If you're an iOS developer, most likely you've had to deal with code signing. And if you're a junior iOS developer, you might've felt a bit overwhelmed by everything going on in the "Certificates, Identifiers &#x26; Profiles" section of the developer portal.</p>
<p align="center"><img src="https://cdn-laravel.vapor.cloud/image/nstack/translate-values/hbikk_ospmSpNLyW_X9dvSRTF8j.gif" /></p>
<p>The goal of this article is to help junior iOS developers understand code signing on a higher level. This will not be a step-by-step tutorial on how to code sign your app. Ideally, after reading this article, you will be able to code sign your app without following any tutorials.</p>
<p>I don't plan to go into lower level details, but we will talk a bit about asymmetric cryptography.</p>
<h3>Asymmetric cryptography</h3>
<p>The minimum you need to know is that asymmetric cryptography uses a <strong>public key</strong> and a <strong>private key</strong>. The users have to keep their private key for themselves, but they can share the public key. And using those public and private keys, a user can prove that he is indeed himself.</p>
<p>A good high-level explanation of asymmetric cryptography can be found <a href="https://blog.vrypan.net/2013/08/28/public-key-cryptography-for-non-geeks/">here</a>. If you want to know implementation details or the math behind this, you can find them online.</p>
<h3>App ID</h3>
<p>The App ID is the unique identifier of your app. It consists of a team id, generated by Apple (you don't have any control over it) and your app's bundle id (<code>com.youcompany.yourapp</code>, for example).</p>
<p>There can also be wildcard App IDs: <code>com.yourcompany.*</code>. Those will match on multiple bundle ids.</p>
<p>Generally, you will have an explicit App ID, not a wildcard one.</p>
<h3>Certificates</h3>
<p>You have probably already noticed that in order to create a certificate in Apple's developer portal, you need to upload a Certificate Signing Request. You can generate this CSR from the Keychain, and this CSR contains a private key.</p>
<p>Then on the developer portal, you can create a certificate using this CSR.</p>
<p>There can be multiple types of certificates. The most common are:</p>
<ul>
<li>Development (iOS App Development) - You need those to run your app on a device from Xcode.</li>
<li>Distribution (App Store and Ad Hoc) - You need those to be able to distribute your app through the App Store or Ad Hoc</li>
<li>APNS (Apple Push Notification Service) - You need those to be able to send push notifications to your app. Unlike Development or Distribution certificates, APNS certificates are associated with an App ID. There can be 2 types of APNS certificates, for development - Apple Push Notification service SSL (Sandbox), and for production - Apple Push Notification service SSL (Sandbox &#x26; Production). You need to create both of them if you want push notifications to work on both debug and distribution builds.</li>
</ul>
<h3>Devices</h3>
<p>You can add up to 100 devices per product family per membership year to your account. 100 iPhones, 100 iPads, 100 iPod Touch, 100 Apple Watches and 100 Apple TVs. To add a device to your account, you need to add its unique device ID. You can easily find that in Xcode, or (a bit more complicated) in iTunes. A detailed guide on how to add devices to your account can be found <a href="https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingProfiles/MaintainingProfiles.html#//apple_ref/doc/uid/TP40012582-CH30-SW10">here</a>.</p>
<h3>Provisioning profiles</h3>
<p>The provisioning profile is what associates an App ID with a certificate and, for development or ad hoc distribution, with some devices. You create the provisioning profiles on the Apple developer portal and you download them in Xcode.</p>
<h3>Usage</h3>
<p>After you have created all these, you can then go to Xcode, add your certificates, refresh your provisioning profiles and then select the provisioning profile you want. You can then select the desired signing identity (based on the certificate associated with it) from that provisioning profile.</p>
<h3>F.A.Q.</h3>
<p>Over the years working in iOS development, I've asked and I've been asked many questions about code signing. Here are some of them.</p>
<ul>
<li>
<p><strong>Q</strong>: I have downloaded the provisioning profiles and certificates from the developer portal, but I can't sign the app.<br>
<strong>A</strong>: Yes, because you don't have the private key, the one that was in the certificate signing request. Most likely, another team member created those certificates and provisioning profiles before. You can get the private key from the original developer, revoke the certificate and generate a new one (which will break all provisioning profiles associated with that certificate, but not any App Store apps using those) or create a new one if possible (currently, there's a maximum of 3 distribution certificates allowed per account).</p>
</li>
<li>
<p><strong>Q</strong>: What about the push certificates? I want my app to receive push notifications. Shouldn't I create a provisioning profile that uses the APNS certificate?<br>
<strong>A</strong>: No. When you create an APNS (Apple Push Notification Service) certificate, you associate that with an App ID. So, first you have your CSR, then you create a new APNS certificate with that CSR, download it, open it in Keychain and export it as .p12, which you later upload to your push notification provider. The .p12 file will know that it's associated with that app, and it will send pushes to that app only. That's also a reason why you can't associate an APNS certificate with a wildcard App ID (com.youcompany.*). The push notification server needs to know to which app it sends the notifications.</p>
</li>
<li>
<p><strong>Q</strong>: I bought a new mac, what should I export from the keychain of my old mac for all the code signing to work on the new one?<br>
<strong>A</strong>: You would probably want all your keychain to be exported to the new mac. You can do that by following <a href="https://support.apple.com/kb/PH20120?locale=en_US">these steps</a>. But if you want to export one certificate, make sure you also export its private key. In the Keychain, you have to be able to expand the certificate by pressing on the arrow next to it, and you should see a key. Those certificates are the ones that can be exported as .p12 files. Otherwise, they'll be exported as .cer, without a private key, and they'll be pretty much useless.</p>
</li>
<li>
<p><strong>Q</strong>: My iOS distribution certificate expired, will my app still work?<br>
<strong>A</strong>: When your certificate expires, the provisioning profiles using that certificate will become invalid. On App Store, the app will still work as long as you're enrolled in the development program. All the ad hoc builds signed with that certificate won't work anymore.</p>
</li>
<li>
<p><strong>Q</strong>: My APNS certificate expired, what happens now?<br>
<strong>A</strong>: You won't be able to send push notifications to the app anymore. This can be fixed by creating a new APNS certificate associated with that App ID, downloading it, exporting its .p12 and uploading it to your push notification service provider. No need for an app update.</p>
</li>
</ul>
<h3>Summary</h3>
<p>The key points I want to highlight about code signing are:</p>
<ul>
<li>Each app has an <strong>App ID</strong>.</li>
<li>You need to have the <strong>private keys</strong> for all the certificates you use.</li>
<li>A <strong>debug provisioning profile</strong> associates your development certificate with your App ID and the devices.</li>
<li>An <strong>ad hoc provisioning profile</strong> associates your distribution certificate with your App ID and the devices.</li>
<li>An <strong>app store provisioning profile</strong> associates your distribution certificate with your App ID.</li>
<li>For push notifications, create an <strong>APNS certificate</strong> associated with your App ID, then download it, export it as .p12 and upload the .p12 to your push notification service provider; if you want push notifications both on debug and production builds, you have to create 2 APNS certificates, one for development and one for production.</li>
</ul>
<p>Understanding these will help you understand code signing and save you a lot of time in the end.</p>
<p align="center"><img src="https://cdn-laravel.vapor.cloud/image/nstack/translate-values/success_YGu5HHLDK6_HD2ZEvLVhV.jpg" width="50%"/>
</p>
<h3>Further reading</h3>
<ul>
<li><a href="https://www.objc.io/issues/17-security/inside-code-signing/">Inside code signing</a></li>
<li><a href="https://developer.apple.com/support/code-signing/">Code Signing</a></li>
<li><a href="https://medium.com/ios-os-x-development/ios-code-signing-provisioning-in-a-nutshell-d5b247760bef">iOS Code Signing &#x26; Provisioning in a Nutshell</a></li>
</ul>
<p><em>Article Photo by <a href="https://unsplash.com/photos/9e9PD9blAto">William Hook</a></em></p>
</div></div><span style="display:table;clear:both"></span></div></main><footer>footer</footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"iOSアプリのコード署名を理解する","lang":"jp","date":"2020-03-16T05:35:07.322Z","slug":"2016-10-27-Understanding-code-signing-for-iOS-apps","author":{"name":"Joe Haddad","picture":"/assets/blog/authors/joe.jpeg"},"content":"\u003cp\u003eIf you're an iOS developer, most likely you've had to deal with code signing. And if you're a junior iOS developer, you might've felt a bit overwhelmed by everything going on in the \"Certificates, Identifiers \u0026#x26; Profiles\" section of the developer portal.\u003c/p\u003e\n\u003cp align=\"center\"\u003e\u003cimg src=\"https://cdn-laravel.vapor.cloud/image/nstack/translate-values/hbikk_ospmSpNLyW_X9dvSRTF8j.gif\" /\u003e\u003c/p\u003e\n\u003cp\u003eThe goal of this article is to help junior iOS developers understand code signing on a higher level. This will not be a step-by-step tutorial on how to code sign your app. Ideally, after reading this article, you will be able to code sign your app without following any tutorials.\u003c/p\u003e\n\u003cp\u003eI don't plan to go into lower level details, but we will talk a bit about asymmetric cryptography.\u003c/p\u003e\n\u003ch3\u003eAsymmetric cryptography\u003c/h3\u003e\n\u003cp\u003eThe minimum you need to know is that asymmetric cryptography uses a \u003cstrong\u003epublic key\u003c/strong\u003e and a \u003cstrong\u003eprivate key\u003c/strong\u003e. The users have to keep their private key for themselves, but they can share the public key. And using those public and private keys, a user can prove that he is indeed himself.\u003c/p\u003e\n\u003cp\u003eA good high-level explanation of asymmetric cryptography can be found \u003ca href=\"https://blog.vrypan.net/2013/08/28/public-key-cryptography-for-non-geeks/\"\u003ehere\u003c/a\u003e. If you want to know implementation details or the math behind this, you can find them online.\u003c/p\u003e\n\u003ch3\u003eApp ID\u003c/h3\u003e\n\u003cp\u003eThe App ID is the unique identifier of your app. It consists of a team id, generated by Apple (you don't have any control over it) and your app's bundle id (\u003ccode\u003ecom.youcompany.yourapp\u003c/code\u003e, for example).\u003c/p\u003e\n\u003cp\u003eThere can also be wildcard App IDs: \u003ccode\u003ecom.yourcompany.*\u003c/code\u003e. Those will match on multiple bundle ids.\u003c/p\u003e\n\u003cp\u003eGenerally, you will have an explicit App ID, not a wildcard one.\u003c/p\u003e\n\u003ch3\u003eCertificates\u003c/h3\u003e\n\u003cp\u003eYou have probably already noticed that in order to create a certificate in Apple's developer portal, you need to upload a Certificate Signing Request. You can generate this CSR from the Keychain, and this CSR contains a private key.\u003c/p\u003e\n\u003cp\u003eThen on the developer portal, you can create a certificate using this CSR.\u003c/p\u003e\n\u003cp\u003eThere can be multiple types of certificates. The most common are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDevelopment (iOS App Development) - You need those to run your app on a device from Xcode.\u003c/li\u003e\n\u003cli\u003eDistribution (App Store and Ad Hoc) - You need those to be able to distribute your app through the App Store or Ad Hoc\u003c/li\u003e\n\u003cli\u003eAPNS (Apple Push Notification Service) - You need those to be able to send push notifications to your app. Unlike Development or Distribution certificates, APNS certificates are associated with an App ID. There can be 2 types of APNS certificates, for development - Apple Push Notification service SSL (Sandbox), and for production - Apple Push Notification service SSL (Sandbox \u0026#x26; Production). You need to create both of them if you want push notifications to work on both debug and distribution builds.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eDevices\u003c/h3\u003e\n\u003cp\u003eYou can add up to 100 devices per product family per membership year to your account. 100 iPhones, 100 iPads, 100 iPod Touch, 100 Apple Watches and 100 Apple TVs. To add a device to your account, you need to add its unique device ID. You can easily find that in Xcode, or (a bit more complicated) in iTunes. A detailed guide on how to add devices to your account can be found \u003ca href=\"https://developer.apple.com/library/content/documentation/IDEs/Conceptual/AppDistributionGuide/MaintainingProfiles/MaintainingProfiles.html#//apple_ref/doc/uid/TP40012582-CH30-SW10\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3\u003eProvisioning profiles\u003c/h3\u003e\n\u003cp\u003eThe provisioning profile is what associates an App ID with a certificate and, for development or ad hoc distribution, with some devices. You create the provisioning profiles on the Apple developer portal and you download them in Xcode.\u003c/p\u003e\n\u003ch3\u003eUsage\u003c/h3\u003e\n\u003cp\u003eAfter you have created all these, you can then go to Xcode, add your certificates, refresh your provisioning profiles and then select the provisioning profile you want. You can then select the desired signing identity (based on the certificate associated with it) from that provisioning profile.\u003c/p\u003e\n\u003ch3\u003eF.A.Q.\u003c/h3\u003e\n\u003cp\u003eOver the years working in iOS development, I've asked and I've been asked many questions about code signing. Here are some of them.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eQ\u003c/strong\u003e: I have downloaded the provisioning profiles and certificates from the developer portal, but I can't sign the app.\u003cbr\u003e\n\u003cstrong\u003eA\u003c/strong\u003e: Yes, because you don't have the private key, the one that was in the certificate signing request. Most likely, another team member created those certificates and provisioning profiles before. You can get the private key from the original developer, revoke the certificate and generate a new one (which will break all provisioning profiles associated with that certificate, but not any App Store apps using those) or create a new one if possible (currently, there's a maximum of 3 distribution certificates allowed per account).\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eQ\u003c/strong\u003e: What about the push certificates? I want my app to receive push notifications. Shouldn't I create a provisioning profile that uses the APNS certificate?\u003cbr\u003e\n\u003cstrong\u003eA\u003c/strong\u003e: No. When you create an APNS (Apple Push Notification Service) certificate, you associate that with an App ID. So, first you have your CSR, then you create a new APNS certificate with that CSR, download it, open it in Keychain and export it as .p12, which you later upload to your push notification provider. The .p12 file will know that it's associated with that app, and it will send pushes to that app only. That's also a reason why you can't associate an APNS certificate with a wildcard App ID (com.youcompany.*). The push notification server needs to know to which app it sends the notifications.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eQ\u003c/strong\u003e: I bought a new mac, what should I export from the keychain of my old mac for all the code signing to work on the new one?\u003cbr\u003e\n\u003cstrong\u003eA\u003c/strong\u003e: You would probably want all your keychain to be exported to the new mac. You can do that by following \u003ca href=\"https://support.apple.com/kb/PH20120?locale=en_US\"\u003ethese steps\u003c/a\u003e. But if you want to export one certificate, make sure you also export its private key. In the Keychain, you have to be able to expand the certificate by pressing on the arrow next to it, and you should see a key. Those certificates are the ones that can be exported as .p12 files. Otherwise, they'll be exported as .cer, without a private key, and they'll be pretty much useless.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eQ\u003c/strong\u003e: My iOS distribution certificate expired, will my app still work?\u003cbr\u003e\n\u003cstrong\u003eA\u003c/strong\u003e: When your certificate expires, the provisioning profiles using that certificate will become invalid. On App Store, the app will still work as long as you're enrolled in the development program. All the ad hoc builds signed with that certificate won't work anymore.\u003c/p\u003e\n\u003c/li\u003e\n\u003cli\u003e\n\u003cp\u003e\u003cstrong\u003eQ\u003c/strong\u003e: My APNS certificate expired, what happens now?\u003cbr\u003e\n\u003cstrong\u003eA\u003c/strong\u003e: You won't be able to send push notifications to the app anymore. This can be fixed by creating a new APNS certificate associated with that App ID, downloading it, exporting its .p12 and uploading it to your push notification service provider. No need for an app update.\u003c/p\u003e\n\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eSummary\u003c/h3\u003e\n\u003cp\u003eThe key points I want to highlight about code signing are:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eEach app has an \u003cstrong\u003eApp ID\u003c/strong\u003e.\u003c/li\u003e\n\u003cli\u003eYou need to have the \u003cstrong\u003eprivate keys\u003c/strong\u003e for all the certificates you use.\u003c/li\u003e\n\u003cli\u003eA \u003cstrong\u003edebug provisioning profile\u003c/strong\u003e associates your development certificate with your App ID and the devices.\u003c/li\u003e\n\u003cli\u003eAn \u003cstrong\u003ead hoc provisioning profile\u003c/strong\u003e associates your distribution certificate with your App ID and the devices.\u003c/li\u003e\n\u003cli\u003eAn \u003cstrong\u003eapp store provisioning profile\u003c/strong\u003e associates your distribution certificate with your App ID.\u003c/li\u003e\n\u003cli\u003eFor push notifications, create an \u003cstrong\u003eAPNS certificate\u003c/strong\u003e associated with your App ID, then download it, export it as .p12 and upload the .p12 to your push notification service provider; if you want push notifications both on debug and production builds, you have to create 2 APNS certificates, one for development and one for production.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eUnderstanding these will help you understand code signing and save you a lot of time in the end.\u003c/p\u003e\n\u003cp align=\"center\"\u003e\u003cimg src=\"https://cdn-laravel.vapor.cloud/image/nstack/translate-values/success_YGu5HHLDK6_HD2ZEvLVhV.jpg\" width=\"50%\"/\u003e\n\u003c/p\u003e\n\u003ch3\u003eFurther reading\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.objc.io/issues/17-security/inside-code-signing/\"\u003eInside code signing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://developer.apple.com/support/code-signing/\"\u003eCode Signing\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://medium.com/ios-os-x-development/ios-code-signing-provisioning-in-a-nutshell-d5b247760bef\"\u003eiOS Code Signing \u0026#x26; Provisioning in a Nutshell\u003c/a\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003e\u003cem\u003eArticle Photo by \u003ca href=\"https://unsplash.com/photos/9e9PD9blAto\"\u003eWilliam Hook\u003c/a\u003e\u003c/em\u003e\u003c/p\u003e\n","ogImage":{"url":"/assets/blog/preview/cover.jpg"},"coverImage":"/assets/blog/preview/cover.jpg"},"localization":{"locale":"en","translations":{"heroTitle":"Welcome to Monstarlab's Engineering Blog","heroDescription":"We love engaging with the tech community, and we are big consumers of the awesome work that people share online.  Here we are going give back a little and share our tech knowledge about all things we do at Monstarlab.","common":{"navHome":"Home","localeSwitcher":"Language"}},"namespace":"home"}},"__N_SSG":true},"page":"/[lang]/posts/[slug]","query":{"lang":"en","slug":"2016-10-27-Understanding-code-signing-for-iOS-apps"},"buildId":"_ncXF2uMHlkWHom5uAOhY","assetPrefix":"/blog","runtimeConfig":{},"isFallback":false,"gsp":true}</script><script nomodule="" src="/blog/_next/static/chunks/polyfills-af28de04c604a2479390.js"></script><script src="/blog/_next/static/chunks/webpack-50bee04d1dc61f8adf5b.js" async=""></script><script src="/blog/_next/static/chunks/framework.15878d4e523f86636251.js" async=""></script><script src="/blog/_next/static/chunks/9b974c4f0af01532965b68ee65e3c6bfc9ba8874.7ca2816e457bafd5946e.js" async=""></script><script src="/blog/_next/static/chunks/main-c8c45755b4609bf23bc4.js" async=""></script><script src="/blog/_next/static/chunks/2b45cbd87133d4142bedfa00394b1b98eeb2e753.305d3433611fa22812ed.js" async=""></script><script src="/blog/_next/static/chunks/pages/_app-95468d8a5f6e7e48bae5.js" async=""></script><script src="/blog/_next/static/chunks/5993a6fbe10bd7e58099f74b46323b252f0ba77f.4070ac60c7c7fe2c9267.js" async=""></script><script src="/blog/_next/static/chunks/pages/%5Blang%5D/posts/%5Bslug%5D-2c24168649a128d0ac79.js" async=""></script><script src="/blog/_next/static/_ncXF2uMHlkWHom5uAOhY/_buildManifest.js" async=""></script><script src="/blog/_next/static/_ncXF2uMHlkWHom5uAOhY/_ssgManifest.js" async=""></script></body></html>